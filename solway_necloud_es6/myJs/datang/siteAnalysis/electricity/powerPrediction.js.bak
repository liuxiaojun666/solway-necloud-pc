ajaxData({
    list: {
        name: 'GETforecastPowerList',
        data: {
            dateStr: (new Date).Format('yyyy-MM-dd')
        },
        later: true,
        onlyLatest: true
    },
    line: {
        name: 'GETforecastPowerLine',
        data: {
            dateStr: (new Date).Format('yyyy-MM-dd')
        },
        later: true,
        onlyLatest: true
    },
}, {
    })('powerPredictionCtrl', ['$scope', 'myAjaxData'], ($scope, myAjaxData) => {
        $scope.dateTime1 = new Date;
        $scope.dateTime2 = new Date;
        $scope.customLoading = true;

        $scope.allGetDataCallback = () => $scope.customLoading = false;

        $scope.updated = async () => {
            await myAjaxData.timeout(0);
            $scope.customLoading = true;
            $scope.list.getData({dateStr: $scope.dateTime1.showDate});
            $scope.line.getData({dateStr: $scope.dateTime1.showDate});
        };

        $scope.line.getDataCallback = async () => {
            await myAjaxData.timeout(10000);
            if ($scope.customLoading) return;
            $scope.list.getData({});
            $scope.line.getData({});
        };

        $scope.$on('$destroy', () => $scope.customLoading = true);
    });
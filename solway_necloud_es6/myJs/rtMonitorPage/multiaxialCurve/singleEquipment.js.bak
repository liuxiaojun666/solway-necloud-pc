app.directive('seChart', ['myAjaxData', myAjaxData => ({
    restrict: 'E',
    transclude: !0,
    replace: !0,
    scope: {

    },
    link($scope, $element) {
        const option = {
            backgroundColor: '#fff',
            "tooltip": {
                "trigger": "axis"
            },
            xAxis: {
                type: 'category',
                data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']
            },
            grid: {
                left: 60,
                right: 60,
                bottom: 20,
                containLabel: true
            },
            yAxis: [
                {
                    name: 'hello',
                    position: 'left',
                    offset: 0,
                    splitLine: {
                        show: false
                    },
                    type: 'value'
                },
                {
                    name: 'hello',
                    position: 'left',
                    offset: 60,
                    splitLine: {
                        show: false
                    },
                    type: 'value'
                }
            ],
            series: [
                {
                    data: [820, 932, 901, 934, 1290, 1330, 1320],
                    yAxisIndex: 0,
                    type: 'line'
                }, {
                    data: [80, 92, 91, 94, 120, 130, 120],
                    yAxisIndex: 1,
                    type: 'line'
                },
            ]
        };


        setTimeout(() => {
            const myChart = echarts.init($element[0]);
            myChart.setOption(option);
            window.addEventListener('resize', myChart.resize);
            $scope.$on('$destroy', () => window.removeEventListener('resize', myChart.resize))
        }, 0);
    }
})]);

ajaxData({}, {})('singleEquipmentCtrl', ['$scope', 'myAjaxData'], ($scope, myAjaxData) => {
    $scope.startDate = new Date;//历史曲线 开始 时间
    $scope.endDate = new Date;//历史曲线 结束 时间
    $scope.selectedEquipments = [];//已选择的设备

    $scope.equipments = new Array(30).fill('').map((v, i) => ({
        name: `a#${i}`,
        id: i + 1
    }))

    // 选择设备执行
    $('#equipments').on('click', 'input', function (e) {

        const equipmentId = this.dataset['id']

        if (this.checked) {

            if ($scope.selectedEquipments.length < 1) $scope.selectedEquipments.push(equipmentId);

            else this.checked = false;

        } else $scope.selectedEquipments = $scope.selectedEquipments.filter(v => v != equipmentId);
    });






















    const getWindowHeight = () => {
        $scope.windowHeight = document.body.clientHeight;
        $scope.windowWidth = document.body.clientWidth;
        $scope.$apply()
    };
    setTimeout(getWindowHeight, 0);
    window.addEventListener('resize', getWindowHeight);
    $scope.$on('$destroy', () => window.removeEventListener('resize', getWindowHeight));
});
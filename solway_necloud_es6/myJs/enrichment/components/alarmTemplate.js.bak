app.directive('alarmTemplate', ['$ocLazyLoad', '$http', '$state', '$timeout','$rootScope', ($ocLazyLoad, $http, $state, $timeout,$rootScope) => ({
    restrict: 'E',
    transclude: !0,
    replace: !0,
    scope: {

    },
    templateUrl: 'tpl/enrichment/components/alarmTemplate.html',
    link($scope, $element) {
        //报警状态
        $scope.currentStatus = 'abnormal'; //abnormal,normal

        if($scope.currentStatus == 'abnormal'){
            $scope.alarmListPageShow = false;
            $scope.ifTwinkle = true;
        }

        //设置列表高度
        const calculateListHeight = () =>{
            $(".alarm-list").height($(window).height()-68);
        }
    
        calculateListHeight();
        window.addEventListener('resize', calculateListHeight);

        //下拉或者收缩
        $scope.toggleAlarmList = () =>{
            $scope.alarmListPageShow = !$scope.alarmListPageShow;
            if ($scope.alarmListPageShow) {
                $scope.ifTwinkle = false;
                $(".alarm-list").slideDown();
            } else {
                $scope.ifTwinkle = true;
                $(".alarm-list").slideUp();
            }
        }

        //测试
        $scope.datalist = [{"mid":1976674,"mc":"锅炉房逆变器C4\r\n通讯中断","mbc":null,"mhs":"05","musname":"系统","musname_real":"1234","murname":"1234","murname_real":"郭宗军",
        "unread_num":0,"lid":null,"lusname":"1234","lusname_real":"1234","lurname":"郭宗军","lurname_real":"郭宗军","lc":"完成了工作任务T20180904100609，申请验收","ct":1536026797000,
        "busitype":"00","busino":"1620625","musid_real":null,"recoveryTime":1536009959000,"stid":3002,"stname":"马鞍山蒙牛"}]
        $scope.column = [
            {
                title: '<label class="i-checks m-b-none"><input type="checkbox"><i style="background:transparent;"></i></label>',
                dataIndex: '',
                width: '60px',
                align: 'center',
                checkboxName: 'batchprocessing',
                render(text, record, index) {
                    return '<label class="i-checks m-b-none"><input data-identifies="' + record.id + '" name="batchprocessing" type="checkbox" /><i style="background:transparent;"></i></label>';
                }
            },
            {
                title: '电站名称',
                dataIndex: 'stationName',
                width: '20%',
            },
            {
                title: '设备名称',
                dataIndex: '',
                width: '20%',
            },
            {
                title: '故障类型',
                dataIndex: '',
            },
            {
                title: '发生时间',
                dataIndex: '',
            },
            {
                title: '事件描述',
                dataIndex: '',
            },
            {
                title: '确认时间',
                dataIndex: '',
            },
            {
                title: '确认',
                dataIndex: '',
            }
        ];

        $scope.$on('$destroy', () => {
            window.removeEventListener('resize', calculateListHeight);
        });
    }
})])

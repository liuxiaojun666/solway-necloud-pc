ajaxData(
    {

    },
    {
        __serviceName__: 'actionPlanSummaryStationEquipmentMedicalService',
    }
)('actionPlanSummaryStationEquipmentMedicalCtrl', ['$scope', 'actionPlanSummaryStationEquipmentMedicalService',
    'actionRecord'], ($scope, myAjaxData, historicalRecord) => {
        /// 初始化 scope
        $scope.initChildScope($scope, myAjaxData);

        // 主页面初始化完成 回调
        $scope.mainPageInitComplete = async () => {
            let { tabIndex = 0 } = historicalRecord.get().actionPlanSummaryStationEquipmentMedical || {};
            $scope.changeTab(tabIndex);
            $('.ng-clock').removeClass('ng-clock');
            $scope.initComplete = true;
            await myAjaxData.timeout(0);
            await $scope.diffGetData();
            $scope.$apply();
        };

        $scope.column = [
            {
                title: '设备名称',
                dataIndex: '',
                align: 'left',
                render(text) {
                    return 'hello'
                }
            },
            {
                title: '故障类型',
                dataIndex: '',
                align: 'left',
                render(text) {
                    return 'hello'
                }
            },
            {
                title: '故障内容',
                dataIndex: '',
                align: 'left',
                render(text) {
                    return 'hello'
                }
            },
            {
                title: '故障时间',
                dataIndex: '',
                align: 'left',
                render(text) {
                    return 'hello'
                }
            },
            {
                title: '设备状态',
                dataIndex: '',
                align: 'left',
                render(text) {
                    return 'hello'
                }
            },
            {
                title: '处理状态',
                dataIndex: '',
                align: 'left',
                render(text) {
                    return 'hello'
                }
            },
        ];

        $scope.column1 = [
            {
                title: '设备名称',
                dataIndex: '',
                align: 'left',
                render(text) {
                    return 'hello'
                }
            },
            {
                title: '故障类型',
                dataIndex: '',
                align: 'left',
                render(text) {
                    return 'hello'
                }
            },
            {
                title: '故障内容',
                dataIndex: '',
                align: 'left',
                render(text) {
                    return 'hello'
                }
            },
        ];
        // 切换电站 回调
        $scope.switchPowerCallback = () => {
            $scope.diffGetData();
        };

        // tab 切换
        $scope.changeTab = tabIndex => {
            $scope.tabIndex = tabIndex;
            historicalRecord.set({
                actionPlanSummaryStationEquipmentMedical: {
                    ...historicalRecord.get().actionPlanSummaryStationEquipmentMedical || {},
                    tabIndex
                }
            });
            $scope.diffGetData();
        };

        // 接口请求
        $scope.diffGetData = async (getInfo) => {
            if (!$scope.initComplete) return;
            await myAjaxData.timeout(0);
            setDataNull(getInfo);
            const { tabIndex, dataType } = $scope;
            if (dataType !== 0) return;
        };

        // 数据置空
        function setDataNull(getInfo) {

        }


        // 键盘 左右 键   切换主题  组合键 放大缩小（ctrl + M）
        $(document).on('keydown', keyChangeTheme);
        $scope.$on('$destroy', () => $(document).off('keydown', keyChangeTheme));
        function keyChangeTheme(event) {
            const { tabIndex } = $scope;
            switch (event.keyCode) {
                case 38:
                    if (tabIndex === 0) return;
                    $scope.changeTab(tabIndex - 1);
                    $scope.$apply();
                    break;

                case 40:
                    if (tabIndex === 1) return;
                    $scope.changeTab(tabIndex + 1);
                    $scope.$apply();
                    break;

                default:
                    break;
            }
        }
        // 销毁 事件
        $scope.$on('$destroy', () => {
            setDataNull();
        });
    });
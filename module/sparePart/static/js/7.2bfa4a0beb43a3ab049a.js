webpackJsonp([7],{"/XM6":function(t,e){},"6Ltk":function(t,e){},QrII:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n("/XM6"),n("VRPH");var a=n("VosF"),o=n.n(a),r=(n("LX/e"),n("STLj")),i=n.n(r),s=(n("Auav"),n("e0Bm")),l=n.n(s),d=(n("0Hv4"),n("pkKZ")),c=n.n(d),f=(n("7oZF"),n("mtrD")),u=n.n(f),p=(n("9niM"),n("HJMx")),m=n.n(p),g=(n("sI00"),n("Mezo")),b=n.n(g),v=(n("evr2"),n("vqwl")),_=n.n(v),y=(n("YeOW"),n("2X9z")),h=n.n(y),D=n("Gu7T"),C=n.n(D),P=n("Dd8w"),I=n.n(P),k=n("FL0G"),x={data:function(){return{opFittingsRoomSelectByCondition:Object(k.v)({onlyLatest:!0,cacheParams:!0,res:{body:[]}}),opFittingsCategorySelectByCondition:Object(k.l)({res:{body:[]},mountedRes:function(t){return t.body=t.body.map(function(t){return{label:t.name,value:t.id}}),t.body.unshift({label:"全部",value:""}),t}}),opFittingsDictSelectCtg1:Object(k.q)({later:!0}),opFittingsDictSelectCtg2:Object(k.r)({later:!0}),opFittingsDictSelectCurrData:Object(k.s)({res:{body:[]},mountedRes:function(t,e,n){return n.firstData||(n.firstData=I()({},t)),t}}),opFittingsDictRoomValidFsn:Object(k.p)({later:!0}),opWorkFittingsInCreate:Object(k.y)({later:!0,sameTimeOnce:!0,beforeSend:function(t){var e=t.goods;return I()({},t,{goods:e.map(function(t){return{fdId:t.fdId,fdPt:t.fdPt,fsn:t.fsn,num:t.num,position:t.position}})})}}),formData:{sn:"",stationId:"",summary:"",goods:[{fdId:void 0,fdPt:0,fsn:"",num:void 0,position:"",edit:!0,spareParts:[]}]}}},created:function(){var t=this;this.opFittingsDictSelectCurrData.subscribe(function(e){t.formData.goods[0].spareParts[0]||(t.formData.goods[0].spareParts=[].concat(C()(e.body)))}),this.opWorkFittingsInCreate.subscribe(function(e){if(0!==e.code)return h.a.error(e.msg);h.a.success(e.msg),t.$route.query.menu?(t.formData.sn="",t.formData.stationId="",t.formData.summary="",t.formData.goods=[t.formData.goods[0]],t.formData.goods[0].fsn="",t.formData.goods[0].position="",t.formData.goods[0].edit=!0,t.$refs.form.resetFields(),t.$refs.spareParts0[0].resetFields()):t.$router.go(-1)})},methods:{lazyLoad:function(t,e){1===t.level?this.opFittingsDictSelectCtg1.getData({categoryId:t.value}).then(function(t){e([{value:"",label:"全部",leaf:!1}].concat(C()(t.body.map(function(t){return{value:t,label:t,leaf:!1}}))))}):2===t.level&&this.opFittingsDictSelectCtg2.getData({categoryId:t.path[0],ctg1:t.value}).then(function(t){e([{value:"",label:"全部",leaf:!0}].concat(C()(t.body.map(function(t){return{value:t,label:t,leaf:!0}}))))})},itemValidate:function(t,e,n){if(t){if(!e.fdPt)return e.edit=!1;for(var a=this.formData.goods,o=0;o<a.length;o++){var r=a[o];if(r.fsn&&r.fsn===e.fsn&&o!==n&&e.fdId===r.fdId)return void h.a.error("备件编号已存在, 与第"+(o+1)+"行备件编号重复，请检查")}this.opFittingsDictRoomValidFsn.getData({fsn:e.fsn}).then(function(t){if(!t.body.flag)return h.a.error("备件编号已存在,请检查！");e.edit=!1})}},allValidate:function(t,e){if(t)return e.goods.some(function(t){return t.edit})?h.a.info("请确认结束编辑状态！"):void this.opWorkFittingsInCreate.getData(e)},fdChange:function(t,e){t?(e.fdPt=+t.split("_")[0],e.fdId=+t.split("_")[1],e.num=e.fdPt?1:void 0):(e.fdPt=0,e.fdId="",e.num=void 0)}},components:{ElForm:_.a,ElFormItem:b.a,ElInput:m.a,ElButton:u.a,ElCascader:c.a,ElSelect:l.a,ElOption:i.a,ElPageHeader:o.a}},F={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"put-in-storage-add"},[n("div",{staticClass:"content"},[t.$route.query.menu?t._e():n("el-page-header",{attrs:{content:"备件入库"},on:{back:function(e){return t.$router.go(-1)}}}),t._v(" "),n("el-form",{ref:"form",attrs:{inline:!0,model:t.formData,"label-width":"80px"}},[n("el-form-item",{attrs:{prop:"sn",rules:{required:!0,message:"入库单号不能为空"},label:"入库单号"}},[n("el-input",{attrs:{placeholder:"请输入入库单号"},model:{value:t.formData.sn,callback:function(e){t.$set(t.formData,"sn",e)},expression:"formData.sn"}})],1),t._v(" "),n("el-form-item",{attrs:{prop:"sn",rules:{required:!0,message:"库房不能为空"},label:"库房"}},[n("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择库房"},model:{value:t.formData.stationId,callback:function(e){t.$set(t.formData,"stationId",e)},expression:"formData.stationId"}},t._l(t.opFittingsRoomSelectByCondition.res.body,function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"备注"}},[n("el-input",{attrs:{type:"textarea",placeholder:"请填写备注"},model:{value:t.formData.summary,callback:function(e){t.$set(t.formData,"summary",e)},expression:"formData.summary"}})],1)],1),t._v(" "),n("div",{staticClass:"sparePartEditList"},t._l(t.formData.goods,function(e,a){return n("el-form",{key:a,ref:"spareParts"+a,refInFor:!0,staticClass:"sparePart",attrs:{inline:!0,model:e,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"备件分类"}},[n("el-cascader",{attrs:{disabled:!e.edit,placeholder:"备件分类",props:{lazy:!0,lazyLoad:t.lazyLoad},clearable:!0,options:t.opFittingsCategorySelectByCondition.res.body},on:{change:function(n){t.opFittingsDictSelectCurrData.getData({categoryId:n[0],ctg1:n[1],ctg2:n[2]}).then(function(t){e.spareParts=t.body,(e.fdId&&!e.spareParts.some(function(t){return t.id===e.fdId})||!e.fdId)&&(e.fdPt_fdId="")})}}})],1),t._v(" "),n("el-form-item",[n("el-select",{attrs:{disabled:!e.edit,filterable:"",clearable:"",placeholder:"分类编号"},on:{change:function(n){return t.fdChange(n,e)}},model:{value:e.fdPt_fdId,callback:function(n){t.$set(e,"fdPt_fdId",n)},expression:"item.fdPt_fdId"}},t._l(e.spareParts,function(t){return n("el-option",{key:t.id,attrs:{label:t.code,value:t.pt+"_"+t.id}})}),1)],1),t._v(" "),n("el-form-item",{attrs:{prop:"fdId",rules:{required:!0,message:"请选择备件"}}},[n("el-select",{attrs:{disabled:!e.edit,filterable:"",clearable:"",placeholder:"名称"},on:{change:function(n){return t.fdChange(n,e)}},model:{value:e.fdPt_fdId,callback:function(n){t.$set(e,"fdPt_fdId",n)},expression:"item.fdPt_fdId"}},t._l(e.spareParts,function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.pt+"_"+t.id}})}),1)],1),t._v(" "),n("el-form-item",[n("el-select",{attrs:{disabled:!e.edit,filterable:"",clearable:"",placeholder:"型号及规格"},on:{change:function(n){return t.fdChange(n,e)}},model:{value:e.fdPt_fdId,callback:function(n){t.$set(e,"fdPt_fdId",n)},expression:"item.fdPt_fdId"}},t._l(e.spareParts,function(t){return n("el-option",{key:t.id,attrs:{label:t.ft,value:t.pt+"_"+t.id}})}),1)],1),t._v(" "),1===e.fdPt?n("el-form-item",{attrs:{prop:"fsn",rules:{required:!0,message:"编号不能为空"}}},[n("el-input",{attrs:{disabled:!e.edit,placeholder:"备件编号"},model:{value:e.fsn,callback:function(n){t.$set(e,"fsn","string"==typeof n?n.trim():n)},expression:"item.fsn"}})],1):t._e(),t._v(" "),0===e.fdPt?n("el-form-item",{attrs:{prop:"num",rules:{required:!0,message:"数量不能为空"}}},[n("el-input",{attrs:{disabled:!e.edit,type:"number",placeholder:"数量"},model:{value:e.num,callback:function(n){t.$set(e,"num",t._n(n))},expression:"item.num"}})],1):t._e(),t._v(" "),n("el-form-item",{attrs:{prop:"position",rules:{required:!0,message:"库位不能为空"}}},[n("el-input",{attrs:{disabled:!e.edit,placeholder:"库位"},model:{value:e.position,callback:function(n){t.$set(e,"position","string"==typeof n?n.trim():n)},expression:"item.position"}})],1),t._v(" "),n("el-form-item",[n("el-button",{staticClass:"delete",attrs:{type:"text"},on:{click:function(){t.formData.goods[1]&&t.formData.goods.splice(a,1)}}},[n("i",{staticClass:"iconfont iconshanchu1",attrs:{title:"删除"}})]),t._v(" "),e.edit?t._e():n("el-button",{staticClass:"edit",attrs:{type:"text"},on:{click:function(t){e.edit=!0}}},[n("i",{staticClass:"iconfont iconbianji-copy",attrs:{title:"编辑"}})]),t._v(" "),e.edit?n("el-button",{staticClass:"confirm",attrs:{type:"text"},on:{click:function(n){t.$refs["spareParts"+a][0].validate(function(n){return t.itemValidate(n,e,a)})}}},[n("i",{staticClass:"iconfont iconqueding",attrs:{title:"确定"}})]):t._e()],1)],1)}),1),t._v(" "),t.formData.goods[0].spareParts?n("el-button",{staticStyle:{"margin-left":"80px"},attrs:{type:"b2"},on:{click:function(e){return t.formData.goods.push(Object.assign({},t.formData.goods[t.formData.goods.length-1],{edit:!0,fsn:"",num:void 0,position:""}))}}},[t._v("添加备件")]):t._e(),t._v(" "),n("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"b1"},on:{click:function(e){t.$refs.form.validate(function(e){return t.allValidate(e,t.formData)})}}},[t._v("提交")])],1)])},staticRenderFns:[]};var S=n("VU/8")(x,F,!1,function(t){n("6Ltk"),n("eJfX")},"data-v-0dcc18b6",null);e.default=S.exports},VosF:function(t,e,n){t.exports=function(t){var e={};function n(a){if(e[a])return e[a].exports;var o=e[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(a,o,function(e){return t[e]}.bind(null,o));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/dist/",n(n.s=86)}({0:function(t,e,n){"use strict";function a(t,e,n,a,o,r,i,s){var l,d="function"==typeof t?t.options:t;if(e&&(d.render=e,d.staticRenderFns=n,d._compiled=!0),a&&(d.functional=!0),r&&(d._scopeId="data-v-"+r),i?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},d._ssrRegister=l):o&&(l=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),l)if(d.functional){d._injectStyles=l;var c=d.render;d.render=function(t,e){return l.call(e),c(t,e)}}else{var f=d.beforeCreate;d.beforeCreate=f?[].concat(f,l):[l]}return{exports:t,options:d}}n.d(e,"a",function(){return a})},20:function(t,e){t.exports=n("urW8")},86:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"el-page-header"},[n("div",{staticClass:"el-page-header__left",on:{click:function(e){t.$emit("back")}}},[n("i",{staticClass:"el-icon-back"}),n("div",{staticClass:"el-page-header__title"},[t._t("title",[t._v(t._s(t.title))])],2)]),n("div",{staticClass:"el-page-header__content"},[t._t("content",[t._v(t._s(t.content))])],2)])};a._withStripped=!0;var o=n(20),r={name:"ElPageHeader",props:{title:{type:String,default:function(){return Object(o.t)("el.pageHeader.title")}},content:String}},i=n(0),s=Object(i.a)(r,a,[],!1,null,null,null);s.options.__file="packages/page-header/src/main.vue";var l=s.exports;l.install=function(t){t.component(l.name,l)};e.default=l}})},eJfX:function(t,e){}});
//# sourceMappingURL=7.2bfa4a0beb43a3ab049a.js.map